# EasyTest-Web 新功能使用指南

> 更新日期：2025-12-28  
> 版本：v1.1

---

## 目录

1. [环境变量使用](#环境变量使用)
2. [集合管理与批量测试](#集合管理与批量测试)
3. [测试报告生成与查看](#测试报告生成与查看)

---

## 环境变量使用

### 功能说明

环境配置中可以自定义变量，在创建测试用例时可以使用这些变量，实现参数化和环境切换。

### 使用步骤

#### 1. 配置环境变量

在 **环境管理** 页面创建或编辑环境时，配置变量：

```json
{
    "name": "开发环境",
    "base_url": "http://localhost:5211",
    "variables": {
        "bearer": "eyJ0eXAiOiJKV1QiLCJhbGci...",
        "userId": "123",
        "version": "v1",
        "timeout": "30"
    },
    "headers": {
        "Content-Type": "application/json"
    }
}
```

#### 2. 在用例中使用变量

创建或编辑测试用例时，使用 `{变量名}` 格式引用环境变量：

**URL 中使用：**
```
http://api.com/{version}/users/{userId}
```

**请求头中使用：**
```json
{
    "Authorization": "Bearer {bearer}",
    "X-Custom-Header": "value-{version}"
}
```

**查询参数中使用：**
```json
{
    "user_id": "{userId}",
    "timeout": "{timeout}"
}
```

**请求体中使用：**
```json
{
    "user_id": "{userId}",
    "version": "{version}"
}
```

#### 3. 执行时自动替换

执行测试用例时，系统会自动将所有 `{变量名}` 替换为环境中配置的实际值。

### 变量使用技巧

1. **Token 管理**：将认证 Token 配置为环境变量，方便统一管理和更新
   ```json
   {
       "bearer": "your_access_token",
       "apiKey": "your_api_key"
   }
   ```

2. **动态路径**：使用变量构建动态 URL 路径
   ```
   http://api.com/{version}/users/{userId}/profile
   ```

3. **环境切换**：不同环境配置不同的变量值，切换环境即可切换测试目标
   - 开发环境：`baseUrl = "http://localhost:5211"`
   - 测试环境：`baseUrl = "http://test.example.com"`
   - 生产环境：`baseUrl = "https://api.example.com"`

4. **变量提示**：在接口测试工作台中，选择环境后会显示可用变量列表，点击变量名可快速复制

---

## 集合管理与批量测试

### 功能说明

用例集合功能允许您对测试用例进行分类管理，并支持一次性批量执行集合中的所有用例。

### 使用步骤

#### 1. 创建集合

在 **接口测试工作台** 或 **集合管理** 页面：

1. 点击 **"新建集合"** 按钮
2. 填写集合信息：
   - 名称：例如 "用户模块接口"
   - 描述：例如 "用户注册、登录、信息管理相关接口"
3. 点击确定创建

#### 2. 将用例分配到集合

创建或编辑测试用例时：

1. 在用例表单中选择 **"所属集合"**
2. 从下拉列表中选择对应的集合
3. 保存用例

#### 3. 批量运行集合

在集合列表中：

1. 找到要运行的集合
2. 点击 **"运行"** 按钮
3. 在弹出的对话框中：
   - 选择要使用的测试环境（可选）
   - 点击 **"开始运行"**
4. 等待执行完成，系统会显示测试结果摘要

#### 4. 查看执行结果

批量测试执行完成后：

- 会自动生成测试报告
- 显示通过/失败数量和详细结果
- 可以跳转到测试报告页面查看详细信息

### 集合管理最佳实践

1. **按模块划分**：根据业务模块创建集合
   - 用户模块
   - 订单模块
   - 支付模块
   - 等等

2. **按功能划分**：根据功能特性创建集合
   - 认证接口
   - CRUD 操作
   - 搜索与筛选
   - 等等

3. **按优先级划分**：
   - 冒烟测试集合（核心功能）
   - 回归测试集合（全量测试）
   - 性能测试集合

4. **合理命名**：使用清晰的命名规则
   - ✅ "用户模块 - 登录注册"
   - ✅ "订单管理 - CRUD 操作"
   - ❌ "集合1"、"测试"

---

## 测试报告生成与查看

### 功能说明

系统会自动为批量测试生成详细的测试报告，包括执行结果、统计数据、错误信息等。

### 报告类型

目前支持三种测试类型的报告：

1. **接口测试报告**：API 测试执行结果
2. **Web 测试报告**：UI 自动化测试结果
3. **性能测试报告**：压力测试结果

### 报告生成

报告在以下情况自动生成：

1. **集合批量测试**：执行集合的所有用例后自动生成
2. **Web 脚本执行**：运行 Web 测试脚本后生成
3. **性能测试执行**：完成性能测试场景后生成

### 查看报告

#### 在测试报告页面查看

1. 进入 **"测试报告"** 页面
2. 可以通过以下方式筛选：
   - 测试类型（接口/Web/性能）
   - 项目
   - 时间范围
3. 点击报告的 **"查看"** 按钮

#### 报告内容

报告包含以下信息：

**摘要信息：**
- 总用例数
- 通过数 / 失败数
- 成功率
- 执行耗时
- 测试环境

**详细结果：**
- 每个用例的执行状态
- 响应时间
- 错误信息（如果失败）
- 响应内容（部分）

**环境信息：**
- 使用的测试环境
- 环境配置信息

### 报告操作

1. **查看 HTML 报告**：在浏览器中查看格式化的报告
2. **下载报告**：下载 HTML 格式的报告文件
3. **删除报告**：删除不需要的历史报告
4. **分享报告**：复制报告链接分享给团队成员

### 报告最佳实践

1. **定期清理**：定期清理旧的测试报告，避免数据冗余

2. **报告归档**：重要的测试报告可以下载保存

3. **问题追踪**：失败的测试用例可以：
   - 记录错误信息
   - 分析失败原因
   - 创建 Bug 单
   - 修复后回归测试

4. **趋势分析**：通过多次测试报告对比：
   - 测试通过率趋势
   - 接口响应时间变化
   - 常见失败用例

---

## 完整工作流示例

### 场景：测试用户模块接口

#### 步骤 1：配置环境

创建开发环境：

```json
{
    "name": "开发环境",
    "base_url": "http://localhost:5211",
    "variables": {
        "bearer": "测试用的Token",
        "testUserId": "123",
        "version": "v1"
    }
}
```

#### 步骤 2：创建集合

创建 "用户模块接口" 集合，描述为 "用户注册、登录、信息查询等接口测试"。

#### 步骤 3：创建测试用例

**用例1：用户注册**
```json
{
    "name": "用户注册",
    "method": "POST",
    "url": "{base_url}/api/{version}/auth/register",
    "body": {
        "username": "testuser_{testUserId}",
        "email": "test@example.com",
        "password": "password123"
    },
    "collection_id": 1
}
```

**用例2：用户登录**
```json
{
    "name": "用户登录",
    "method": "POST",
    "url": "{base_url}/api/{version}/auth/login",
    "body": {
        "username": "testuser_{testUserId}",
        "password": "password123"
    },
    "collection_id": 1
}
```

**用例3：获取用户信息**
```json
{
    "name": "获取用户信息",
    "method": "GET",
    "url": "{base_url}/api/{version}/auth/me",
    "headers": {
        "Authorization": "Bearer {bearer}"
    },
    "collection_id": 1
}
```

#### 步骤 4：批量执行

1. 在集合管理中找到 "用户模块接口"
2. 点击 "运行" 按钮
3. 选择 "开发环境"
4. 点击 "开始运行"

#### 步骤 5：查看报告

1. 执行完成后会显示结果摘要
2. 进入 "测试报告" 页面
3. 查看最新生成的报告
4. 分析通过/失败情况
5. 如有失败用例，查看错误详情并修复

---

## 常见问题

### Q1: 变量没有被替换？

**A:** 请检查：
1. 环境中是否配置了该变量
2. 变量名是否正确（区分大小写）
3. 格式是否正确（应该是 `{变量名}`，不是 `{{变量名}}`）
4. 执行时是否选择了对应的环境

### Q2: 批量测试时部分用例失败？

**A:** 可以：
1. 查看测试报告中的错误信息
2. 单独运行失败的用例进行调试
3. 检查用例的依赖关系（如登录 Token）
4. 确认测试环境的状态

### Q3: 如何在不同环境间切换测试？

**A:** 
1. 为每个环境创建独立的环境配置
2. 使用相同的变量名，但配置不同的值
3. 执行测试时选择对应的环境即可

### Q4: 报告可以导出吗？

**A:** 
可以。点击报告详情页的 "下载 HTML" 按钮，即可下载完整的 HTML 报告文件。

---

## 更新日志

### v1.1 (2025-12-28)

**新增功能：**
- ✅ 环境变量支持（使用 `{变量名}` 格式）
- ✅ 集合批量测试功能
- ✅ 自动生成测试报告
- ✅ 测试报告查看和管理
- ✅ 环境变量使用提示

**改进：**
- ✅ 优化了集合管理界面
- ✅ 增强了环境配置功能
- ✅ 改进了测试执行流程

---

## 技术支持

如有问题或建议，请联系开发团队或在项目中提交 Issue。
